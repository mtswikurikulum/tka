<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TKA Bahasa Indonesia SMP - Tes Interaktif</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .progress-bar {
            background: #f0f0f0;
            height: 8px;
            border-radius: 4px;
            margin: 20px 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .content {
            padding: 30px;
        }

        .welcome-screen,
        .result-screen,
        .name-screen {
            text-align: center;
            padding: 40px 20px;
        }

        .welcome-screen h2,
        .name-screen h2 {
            font-size: 28px;
            color: #333;
            margin-bottom: 20px;
        }

        .welcome-screen p,
        .name-screen p {
            font-size: 16px;
            color: #666;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .name-input-group {
            max-width: 400px;
            margin: 30px auto;
        }

        .name-input-group label {
            display: block;
            text-align: left;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .name-input-group input {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            transition: border-color 0.3s;
        }

        .name-input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .student-name-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 15px;
            display: inline-block;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            border-radius: 30px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            margin-left: 10px;
        }

        .question-section {
            display: none;
        }

        .question-section.active {
            display: block;
        }

        .text-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            line-height: 1.8;
        }

        .text-title {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }

        .question {
            margin-bottom: 30px;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-number {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }

        .competency-badge {
            background: #e9ecef;
            color: #495057;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 12px;
        }

        .question-text {
            font-size: 16px;
            color: #333;
            margin-bottom: 20px;
            font-weight: 500;
            line-height: 1.6;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .option.selected {
            border-color: #667eea;
            background: #e8edff;
        }

        .option.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        .option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .option input[type="checkbox"],
        .option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .category-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .category-table th,
        .category-table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }

        .category-table th {
            background: #f8f9fa;
            font-weight: bold;
        }

        .category-option {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .category-option label {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .result-screen h2 {
            font-size: 32px;
            color: #333;
            margin-bottom: 20px;
        }

        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 30px auto;
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .score-number {
            font-size: 48px;
            font-weight: bold;
        }

        .score-label {
            font-size: 16px;
            opacity: 0.9;
        }

        .result-details {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .competency-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .competency-card {
            background: white;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 10px;
        }

        .competency-card h4 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .competency-score {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
            }

            .stats {
                flex-direction: column;
                gap: 15px;
            }

            .navigation {
                flex-direction: column;
                gap: 10px;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üìö TKA Bahasa Indonesia SMP</h1>
            <p>Tes Kemampuan Akademik - Keterampilan Membaca</p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-label">Soal Dijawab</div>
                <div class="stat-value" id="answered">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Total Soal</div>
                <div class="stat-value">30</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Progress</div>
                <div class="stat-value" id="percentage">0%</div>
            </div>
        </div>

        <div class="content">
            <div class="welcome-screen" id="welcomeScreen">
                <h2>Selamat Datang! üëã</h2>
                <p>Tes ini terdiri dari 30 soal yang mengukur kemampuan membaca Anda dalam tiga kompetensi utama:</p>
                <div class="competency-breakdown">
                    <div class="competency-card">
                        <h4>üìñ Pemahaman Tekstual</h4>
                        <p style="font-size: 14px; color: #666;">Memahami informasi eksplisit dalam teks</p>
                    </div>
                    <div class="competency-card">
                        <h4>üîç Pemahaman Inferensial</h4>
                        <p style="font-size: 14px; color: #666;">Menarik kesimpulan dari informasi tersirat</p>
                    </div>
                    <div class="competency-card">
                        <h4>‚≠ê Evaluasi & Apresiasi</h4>
                        <p style="font-size: 14px; color: #666;">Menilai dan menanggapi teks</p>
                    </div>
                </div>
                <p><strong>Petunjuk:</strong> Baca setiap teks dengan cermat, kemudian jawab pertanyaan yang tersedia.
                    Klik "Mulai Tes" untuk memulai.</p>
                <button class="btn" onclick="showNameInput()">Mulai Tes</button>
            </div>

            <div class="name-screen" id="nameScreen" style="display: none;">
                <h2>‚úèÔ∏è Identitas Peserta</h2>
                <p>Silakan masukkan nama Anda sebelum memulai tes</p>
                <div class="name-input-group">
                    <label for="studentName">Nama Lengkap:</label>
                    <input type="text" id="studentName" placeholder="Masukkan nama Anda..." autofocus>
                </div>
                <button class="btn" onclick="startTest()">Mulai Mengerjakan</button>
                <button class="btn btn-secondary" onclick="backToWelcome()">Kembali</button>
            </div>

            <div class="question-section" id="questionSection"></div>

            <div class="result-screen" id="resultScreen" style="display: none;">
                <div class="student-name-display" id="studentNameDisplay"></div>
                <h2>üéâ Tes Selesai!</h2>
                <div class="score-circle">
                    <div class="score-number" id="finalScore">0</div>
                    <div class="score-label">dari 30</div>
                </div>
                <div class="result-details">
                    <div class="result-item">
                        <span>Nilai Akhir:</span>
                        <strong id="scorePercentage">0%</strong>
                    </div>
                    <div class="result-item">
                        <span>Jawaban Benar:</span>
                        <strong id="correctAnswers">0</strong>
                    </div>
                    <div class="result-item">
                        <span>Jawaban Salah:</span>
                        <strong id="wrongAnswers">0</strong>
                    </div>
                </div>
                <h3 style="margin: 30px 0 15px 0; color: #333;">Rincian Per Kompetensi</h3>
                <div class="competency-breakdown" id="competencyResults"></div>
                <button class="btn" onclick="resetTest()">Ulangi Tes</button>
            </div>
        </div>
    </div>

    <script>
        const questions = [
            // PEMAHAMAN TEKSTUAL (11 soal - perwakilan matriks)
            {
                text: `<div class="text-title">Teks Informasi: Energi Terbarukan</div>
                Energi terbarukan adalah energi yang berasal dari sumber daya alam yang dapat diperbaharui secara alami. Panel surya mengubah cahaya matahari menjadi listrik melalui sel fotovoltaik. Turbin angin memanfaatkan kekuatan angin untuk memutar generator. Pembangkit listrik tenaga air menggunakan aliran air untuk menghasilkan energi. Indonesia memiliki potensi besar dalam pengembangan energi terbarukan karena letak geografisnya yang strategis. Pemerintah menargetkan 23% energi nasional berasal dari sumber terbarukan pada tahun 2025.`,
                question: "Istilah 'sel fotovoltaik' dalam teks merujuk pada komponen yang berfungsi untuk ....",
                type: "pg",
                options: [
                    "menyimpan energi listrik dari panel surya",
                    "mengubah cahaya matahari menjadi energi listrik",
                    "menangkap angin untuk menghasilkan listrik",
                    "mengalirkan air ke turbin pembangkit listrik"
                ],
                correct: 1,
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi penggunaan istilah dalam berbagai bidang"
            },
            {
                text: `<div class="text-title">Teks Fiksi: Petualangan di Hutan Hujan</div>
                Kabut tipis menyelimuti puncak-puncak pohon yang menjulang tinggi. Suara gemericik air sungai berpadu dengan kicauan burung eksotis. Akar-akar besar meliuk di tanah basah yang ditumbuhi lumut hijau tebal. Cahaya matahari menembus dedaunan, menciptakan permainan cahaya yang menakjubkan di lantai hutan. Udara lembap bercampur aroma tanah dan daun-daun basah. Di kejauhan, terdengar suara air terjun yang mengalir deras.`,
                question: "Pilihan kata mana yang menunjukkan latar tempat pada teks tersebut?",
                type: "multiple",
                options: [
                    "kabut tipis",
                    "puncak-puncak pohon",
                    "suara gemericik air",
                    "lantai hutan"
                ],
                correct: [1, 3],
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi objek dan/atau latar berdasarkan kosakata"
            },
            {
                text: `<div class="text-title">Teks Informasi: Kerajinan Batik Nusantara</div>
                Batik adalah warisan budaya Indonesia yang telah diakui UNESCO. Proses pembuatan batik dimulai dengan menggambar pola menggunakan malam (lilin) pada kain putih. Setelah itu, kain dicelupkan ke pewarna alami atau sintetis. Malam akan mencegah pewarna meresap ke bagian yang tertutup. Proses ini diulang untuk setiap warna yang diinginkan. Batik tulis memerlukan waktu berbulan-bulan, sedangkan batik cap dapat selesai dalam beberapa hari. Motif batik mencerminkan filosofi dan nilai-nilai budaya daerah asalnya.`,
                question: "Informasi penting yang tersurat dalam teks adalah ....",
                type: "pg",
                options: [
                    "Batik hanya dapat dibuat dengan pewarna alami",
                    "Malam berfungsi mencegah pewarna meresap ke kain",
                    "Semua batik memerlukan waktu berbulan-bulan",
                    "UNESCO menciptakan batik sebagai warisan budaya"
                ],
                correct: 1,
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi informasi penting yang tersurat dalam teks"
            },
            {
                text: `<div class="text-title">Teks Informasi: Proses Fotosintesis</div>
                Fotosintesis adalah proses pembuatan makanan pada tumbuhan hijau. Tumbuhan menyerap karbon dioksida dari udara melalui stomata di daun. Akar menyerap air dan mineral dari tanah. Klorofil dalam daun menangkap energi cahaya matahari. Energi ini digunakan untuk mengubah karbon dioksida dan air menjadi glukosa dan oksigen. Glukosa digunakan sebagai makanan tumbuhan, sedangkan oksigen dilepas ke udara. Proses ini sangat penting bagi kelangsungan hidup makhluk hidup di bumi.`,
                question: "Berdasarkan teks, susunlah kerangka proses fotosintesis yang tepat!",
                type: "category",
                categoryQuestion: "Urutkan langkah-langkah berikut sesuai proses fotosintesis",
                categories: [
                    { statement: "Langkah 1: Penyerapan CO‚ÇÇ melalui stomata", options: ["Benar", "Salah"] },
                    { statement: "Langkah 2: Klorofil menangkap cahaya matahari", options: ["Benar", "Salah"] },
                    { statement: "Langkah 3: Pelepasan karbon dioksida ke udara", options: ["Benar", "Salah"] },
                    { statement: "Langkah 4: Pembentukan glukosa dan oksigen", options: ["Benar", "Salah"] }
                ],
                correct: [0, 0, 1, 0],
                competency: "Pemahaman Tekstual",
                subCompetency: "Menyusun kerangka berdasarkan bagian-bagian penting"
            },
            {
                text: `<div class="text-title">Teks Informasi: Pemanasan Global</div>
                Pemanasan global adalah peningkatan suhu rata-rata atmosfer bumi. Gas rumah kaca seperti karbon dioksida dan metana memerangkap panas di atmosfer. Pembakaran bahan bakar fosil merupakan penyumbang terbesar emisi karbon. Dampaknya meliputi pencairan es di kutub, naiknya permukaan air laut, dan perubahan pola cuaca ekstrem. Upaya mitigasi mencakup penggunaan energi terbarukan, penghijauan, dan pengurangan emisi industri.`,
                question: "Istilah 'gas rumah kaca' dalam teks merujuk pada ....",
                type: "pg",
                options: [
                    "gas yang digunakan di rumah untuk memasak",
                    "gas yang memerangkap panas di atmosfer bumi",
                    "gas yang dihasilkan oleh tanaman hijau",
                    "gas yang dilepaskan saat es mencair"
                ],
                correct: 1,
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi penggunaan istilah dalam berbagai bidang"
            },
            {
                text: `<div class="text-title">Teks Fiksi: Malam di Desa</div>
                Langit malam bertaburan bintang gemerlap. Kunang-kunang beterbangan di antara semak-semak yang mengelilingi sawah. Suara jangkrik bersahut-sahutan memecah kesunyian malam. Angin sepoi-sepoi membawa aroma tanaman padi yang menguning. Di kejauhan, cahaya lampu minyak dari rumah-rumah penduduk berkedip lembut. Bulan purnama menyinari jalan setapak yang berkelok di antara pematang sawah.`,
                question: "Kosakata yang menggambarkan suasana malam di desa ditunjukkan oleh ....",
                type: "multiple",
                options: [
                    "langit malam bertaburan bintang",
                    "kunang-kunang beterbangan",
                    "tanaman padi menguning",
                    "suara jangkrik bersahut-sahutan"
                ],
                correct: [0, 1, 3],
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi objek dan/atau latar berdasarkan kosakata"
            },
            {
                text: `<div class="text-title">Teks Informasi: Sistem Peredaran Darah</div>
                Sistem peredaran darah manusia terdiri dari jantung, pembuluh darah, dan darah. Jantung memompa darah ke seluruh tubuh melalui pembuluh arteri. Darah membawa oksigen dan nutrisi ke sel-sel tubuh. Pembuluh vena membawa darah kembali ke jantung. Jantung memiliki empat ruang: dua atrium dan dua ventrikel. Sistem ini bekerja tanpa henti sepanjang hidup manusia untuk menjaga kelangsungan hidup sel-sel tubuh.`,
                question: "Informasi tersurat tentang fungsi pembuluh vena adalah ....",
                type: "pg",
                options: [
                    "membawa oksigen ke sel-sel tubuh",
                    "memompa darah ke seluruh tubuh",
                    "membawa darah kembali ke jantung",
                    "menyimpan nutrisi untuk tubuh"
                ],
                correct: 2,
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi informasi penting yang tersurat dalam teks"
            },
            {
                text: `<div class="text-title">Teks Informasi: Gunung Berapi Indonesia</div>
                Indonesia memiliki lebih dari 130 gunung berapi aktif, merupakan bagian dari Cincin Api Pasifik. Gunung Merapi di Yogyakarta terkenal sebagai gunung paling aktif. Erupsi gunung berapi menghasilkan abu vulkanik yang menyuburkan tanah. Namun, letusan besar dapat membahayakan penduduk sekitar. PVMBG (Pusat Vulkanologi dan Mitigasi Bencana Geologi) memantau aktivitas gunung berapi secara kontinyu. Sistem peringatan dini telah dipasang di berbagai gunung untuk keselamatan masyarakat.`,
                question: "Istilah teknis yang digunakan dalam bidang geologi adalah ....",
                type: "multiple",
                options: [
                    "Cincin Api Pasifik",
                    "abu vulkanik",
                    "sistem peringatan dini",
                    "erupsi"
                ],
                correct: [0, 1, 3],
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi penggunaan istilah dalam berbagai bidang"
            },
            {
                text: `<div class="text-title">Teks Informasi: Teknologi 5G</div>
                Teknologi 5G adalah generasi kelima jaringan seluler yang menawarkan kecepatan internet hingga 100 kali lebih cepat dari 4G. Latensi yang rendah memungkinkan komunikasi real-time untuk kendaraan otonom dan operasi jarak jauh. Teknologi ini menggunakan frekuensi gelombang milimeter yang lebih tinggi. 5G mendukung konektivitas masif untuk Internet of Things (IoT). Implementasinya memerlukan infrastruktur menara yang lebih padat dibanding generasi sebelumnya.`,
                question: "Informasi penting tentang keunggulan 5G yang tersurat adalah ....",
                type: "pg",
                options: [
                    "menggunakan frekuensi gelombang yang lebih rendah",
                    "memiliki kecepatan hingga 100 kali lebih cepat dari 4G",
                    "tidak memerlukan infrastruktur menara baru",
                    "hanya dapat digunakan untuk telepon seluler"
                ],
                correct: 1,
                competency: "Pemahaman Tekstual",
                subCompetency: "Mengidentifikasi informasi penting yang tersurat dalam teks"
            },
            {
                text: `<div class="text-title">Teks Informasi: Demokrasi Pancasila</div>
                Demokrasi Pancasila adalah sistem demokrasi yang berdasarkan pada nilai-nilai Pancasila. Keputusan diambil melalui musyawarah untuk mencapai mufakat. Kebebasan berpendapat dijamin tetapi tetap menghormati nilai-nilai luhur bangsa. Sistem ini mengutamakan kepentingan bersama di atas kepentingan individu atau golongan. Pemilihan umum dilaksanakan secara langsung, umum, bebas, dan rahasia.`,
                question: "Susunlah kerangka konsep demokrasi Pancasila berdasarkan teks!",
                type: "category",
                categoryQuestion: "Tentukan apakah pernyataan berikut merupakan ciri demokrasi Pancasila",
                categories: [
                    { statement: "Keputusan melalui musyawarah mufakat", options: ["Ya", "Bukan"] },
                    { statement: "Kebebasan tanpa batas", options: ["Ya", "Bukan"] },
                    { statement: "Mengutamakan kepentingan bersama", options: ["Ya", "Bukan"] },
                    { statement: "Pemilu dilaksanakan secara demokratis", options: ["Ya", "Bukan"] }
                ],
                correct: [0, 1, 0, 0],
                competency: "Pemahaman Tekstual",
                subCompetency: "Menyusun kerangka berdasarkan bagian-bagian penting"
            },
            {
                text: `<div class="text-title">Teks Informasi: Metamorfosis Kupu-kupu</div>
                Metamorfosis kupu-kupu adalah proses perubahan bentuk yang menakjubkan. Dimulai dari telur yang menetas menjadi larva (ulat). Ulat memakan daun dalam jumlah besar untuk pertumbuhan. Setelah cukup besar, ulat membentuk kepompong (pupa). Di dalam kepompong terjadi transformasi struktur tubuh. Setelah beberapa minggu, kupu-kupu dewasa keluar dengan sayap yang indah. Proses ini disebut metamorfosis sempurna.`,
                question: "Berdasarkan teks, susunlah urutan tahapan metamorfosis yang benar!",
                type: "category",
                categoryQuestion: "Tentukan urutan tahapan metamorfosis kupu-kupu",
                categories: [
                    { statement: "Tahap 1: Telur", options: ["Benar", "Salah"] },
                    { statement: "Tahap 2: Kupu-kupu dewasa", options: ["Benar", "Salah"] },
                    { statement: "Tahap 3: Larva (ulat)", options: ["Benar", "Salah"] },
                    { statement: "Tahap 4: Pupa (kepompong)", options: ["Benar", "Salah"] }
                ],
                correct: [0, 1, 0, 0],
                competency: "Pemahaman Tekstual",
                subCompetency: "Menyusun kerangka berdasarkan bagian-bagian penting"
            },

            // PEMAHAMAN INFERENSIAL (11 soal - perwakilan matriks)
            {
                text: `<div class="text-title">Teks Informasi: Perubahan Iklim</div>
                Suhu rata-rata bumi meningkat 1,1¬∞C sejak era pra-industri. Lapisan es Arktik menipis dengan kecepatan 13% per dekade. Tinggi permukaan laut naik 3,3 milimeter per tahun. Cuaca ekstrem seperti badai dan kekeringan semakin sering terjadi. Ekosistem terumbu karang mengalami pemutihan massal. Migrasi satwa liar berubah akibat pergeseran habitat. Negara-negara kepulauan menghadapi ancaman tenggelam.`,
                question: "Berdasarkan data dalam teks, dapat disimpulkan bahwa ....",
                type: "pg",
                options: [
                    "perubahan iklim hanya berdampak pada suhu udara",
                    "perubahan iklim memberikan dampak multi-dimensi pada bumi",
                    "kenaikan suhu bumi tidak mempengaruhi ekosistem laut",
                    "negara kepulauan tidak terpengaruh perubahan iklim"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menyimpulkan ide pokok dalam teks"
            },
            {
                text: `<div class="text-title">Teks Fiksi: Persahabatan</div>
                Rina dan Sari telah bersahabat sejak kelas satu. Mereka selalu berbagi cerita dan membantu satu sama lain. Suatu hari, Rina tidak masuk sekolah tanpa kabar. Sari merasa cemas dan langsung mengunjungi rumah Rina setelah sekolah. Ternyata Rina sakit demam tinggi. Tanpa diminta, Sari membantu memberikan catatan pelajaran dan menemani Rina. Orang tua Rina sangat tersentuh melihat kepedulian Sari.`,
                question: "Nilai yang dapat disimpulkan dari cerita tersebut adalah ....",
                type: "pg",
                options: [
                    "pentingnya belajar dengan giat",
                    "kesetiaan dan kepedulian dalam persahabatan",
                    "bahaya penyakit demam tinggi",
                    "pentingnya menjaga kesehatan tubuh"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menyimpulkan nilai-nilai dalam teks"
            },
            {
                text: `<div class="text-title">Teks Informasi: Sampah Plastik di Laut</div>
                Indonesia menghasilkan 67 juta ton sampah per tahun. Sekitar 15% adalah sampah plastik yang berakhir di laut. Mikroplastik ditemukan dalam tubuh ikan yang dikonsumsi manusia. Penyu sering mati karena memakan kantong plastik yang dikira ubur-ubur. Pulau sampah seluas ratusan kilometer persegi terbentuk di Samudera Pasifik. Program pengurangan plastik sekali pakai mulai digalakkan di berbagai daerah.`,
                question: "Hubungan logis antara informasi dalam teks menunjukkan bahwa ....",
                type: "pg",
                options: [
                    "sampah plastik hanya berdampak pada kehidupan laut",
                    "produksi sampah plastik berbanding lurus dengan polusi laut",
                    "mikroplastik tidak berbahaya bagi manusia",
                    "polusi plastik dapat kembali ke rantai makanan manusia"
                ],
                correct: 3,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menjelaskan kelogisan hubungan antarinformasi"
            },
            {
                text: `<div class="text-title">Teks Informasi: Start-up Teknologi</div>
                Jumlah start-up teknologi di Indonesia tumbuh 30% per tahun. Investasi venture capital mencapai 3 miliar dollar pada 2024. E-commerce dan fintech mendominasi sektor start-up. Banyak lulusan universitas memilih menjadi entrepreneur daripada karyawan. Pemerintah memberikan insentif pajak untuk start-up teknologi. Namun, hanya 10% start-up yang bertahan hingga tahun kelima.`,
                question: "Berdasarkan informasi dalam teks, dapat diprediksi bahwa ....",
                type: "pg",
                options: [
                    "semua start-up akan sukses dalam lima tahun",
                    "minat wirausaha muda akan terus meningkat",
                    "investasi venture capital akan menurun drastis",
                    "sektor teknologi akan berhenti berkembang"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Memprediksi peristiwa dalam teks"
            },
            {
                text: `<div class="text-title">Puisi: Hujan di Kota</div>
                Langit menangis di atas kota yang penat
                Tetes-tetes airnya membasuh debu jalanan
                Wajah-wajah lelah tersenyum lega
                Tanaman di pot-pot balkon menari riang
                Anak-anak berlarian menangkap tetes hujan
                Kota yang panas kini menjadi sejuk`,
                question: "Makna 'langit menangis' dalam puisi tersebut adalah ....",
                type: "pg",
                options: [
                    "langit benar-benar sedih dan menangis",
                    "hujan turun dari langit",
                    "langit berwarna gelap dan suram",
                    "ada orang menangis di langit"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menjelaskan bahasa kias dalam teks fiksi"
            },
            {
                text: `<div class="text-title">Teks Informasi: Urbanisasi</div>
                Perpindahan penduduk dari desa ke kota meningkat 5% per tahun. Lapangan kerja di sektor industri dan jasa menarik migrasi. Populasi Jakarta bertambah 200.000 jiwa setiap tahun. Infrastruktur kota tidak mampu menampung pertumbuhan penduduk. Kemacetan, polusi, dan permukiman kumuh menjadi masalah serius. Pemerintah mulai membangun kota-kota satelit untuk mengurangi beban ibu kota.`,
                question: "Ide pokok yang dapat disimpulkan dari teks adalah ....",
                type: "pg",
                options: [
                    "desa lebih baik daripada kota untuk tempat tinggal",
                    "urbanisasi menimbulkan berbagai masalah perkotaan",
                    "semua orang desa harus pindah ke kota",
                    "Jakarta tidak memiliki infrastruktur yang baik"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menyimpulkan ide pokok dalam teks"
            },
            {
                text: `<div class="text-title">Teks Fiksi: Kerja Keras Ayah</div>
                Setiap pagi ayah berangkat sebelum subuh. Sepeda tuanya melintasi jalan setapak menuju ladang. Siang hari ia bekerja di bawah terik matahari. Tangannya yang kasar penuh kapalan menunjukkan perjuangan. Meski lelah, wajahnya selalu cerah saat pulang. Di matanya terpancar harapan untuk masa depan anak-anaknya. Keringat yang mengalir adalah bukti cinta tanpa kata.`,
                question: "Tokoh ayah dalam cerita dapat disimpulkan memiliki karakter ....",
                type: "pg",
                options: [
                    "pemalas dan tidak bertanggung jawab",
                    "pekerja keras dan penuh dedikasi untuk keluarga",
                    "suka mengeluh dan tidak puas dengan hidupnya",
                    "kaya raya dan hidup mewah"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menyimpulkan tokoh dalam teks"
            },
            {
                text: `<div class="text-title">Teks Informasi: Pendidikan Karakter</div>
                Kurikulum 2013 menekankan pendidikan karakter dalam pembelajaran. Nilai-nilai seperti religius, nasionalis, integritas, mandiri, dan gotong royong ditanamkan. Sekolah menerapkan kegiatan pembiasaan seperti upacara, literasi, dan kerja bakti. Evaluasi tidak hanya mengukur aspek kognitif tetapi juga afektif dan psikomotorik. Orang tua dan masyarakat diajak berperan dalam pembentukan karakter siswa.`,
                question: "Hubungan logis antara kurikulum dan pembentukan karakter menunjukkan ....",
                type: "pg",
                options: [
                    "pendidikan hanya fokus pada nilai akademik",
                    "karakter siswa dibentuk secara terintegrasi dalam pendidikan",
                    "orang tua tidak berperan dalam pendidikan anak",
                    "sekolah tidak perlu mengajarkan nilai-nilai karakter"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menjelaskan kelogisan hubungan antargagasan"
            },
            {
                text: `<div class="text-title">Teks Informasi: Inovasi Transportasi</div>
                Mobil listrik mulai populer di Indonesia. Pemerintah memberikan insentif pajak 0% untuk kendaraan listrik. Infrastruktur charging station dibangun di berbagai kota. Emisi karbon dari transportasi turun 15% dalam dua tahun. Produsen otomotif mulai beralih dari mesin konvensional ke listrik. Harga baterai semakin terjangkau seiring perkembangan teknologi.`,
                question: "Dari informasi yang tersaji, dapat diprediksi bahwa ....",
                type: "pg",
                options: [
                    "mobil konvensional akan tetap mendominasi pasar",
                    "adopsi kendaraan listrik akan terus meningkat",
                    "harga kendaraan listrik akan semakin mahal",
                    "emisi karbon akan meningkat drastis"
                ],
                correct: 1,
                competency: "Pemahaman Inferensial",
                subCompetency: "Memprediksi peristiwa dalam teks"
            },
            {
                text: `<div class="text-title">Puisi: Ibu</div>
                Peluh di dahinya adalah embun pagi
                Tangannya adalah taman tempat aku tumbuh
                Senyumnya adalah matahari di hari mendung
                Pelukannya adalah rumah yang paling nyaman
                Doanya adalah sayap yang membawaku terbang
                Ia adalah malaikat tanpa sayap`,
                question: "Citraan yang dominan dalam puisi tersebut adalah ....",
                type: "pg",
                options: [
                    "citraan pendengaran (auditif)",
                    "citraan perabaan (taktil)",
                    "citraan penglihatan (visual) dan perasa (organik)",
                    "citraan penciuman (olfaktori)"
                ],
                correct: 2,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menjelaskan citraan yang digunakan dalam teks fiksi"
            },
            {
                text: `<div class="text-title">Teks Fiksi: Kejujuran Andi</div>
                Andi menemukan dompet berisi uang banyak di halte bus. Ia tahu keluarganya sedang kesulitan ekonomi. Ayahnya kehilangan pekerjaan bulan lalu. Adiknya membutuhkan biaya sekolah. Namun Andi tetap memilih mengembalikan dompet ke kantor polisi. Pemilik dompet yang ternyata seorang pengusaha sangat berterima kasih. Ia terkesan dengan kejujuran Andi dan membantu ayah Andi mendapat pekerjaan.`,
                question: "Peristiwa yang dapat disimpulkan dari cerita adalah ....",
                type: "pg",
                options: [
                    "kejujuran selalu membawa keberuntungan material",
                    "orang miskin tidak boleh mengambil barang yang ditemukan",
                    "nilai moral lebih penting dari keuntungan sesaat",
                    "polisi yang menemukan pekerjaan untuk ayah Andi"
                ],
                correct: 2,
                competency: "Pemahaman Inferensial",
                subCompetency: "Menyimpulkan peristiwa dalam teks"
            },

            // EVALUASI DAN APRESIASI (8 soal - perwakilan matriks)
            {
                text: `<div class="text-title">Teks Informasi: Media Sosial dan Remaja</div>
                Rata-rata remaja menghabiskan 7 jam per hari di media sosial. Mereka sering membandingkan kehidupannya dengan konten yang dilihat online. Perasaan cemas dan tidak percaya diri meningkat. Namun, media sosial juga memberikan platform untuk berkreasi dan berbisnis. Beberapa remaja sukses menjadi content creator dengan penghasilan jutaan rupiah. Orang tua perlu memberikan pendampingan dalam penggunaan media sosial.`,
                question: "Relevansi peristiwa dalam teks dengan kehidupan sehari-hari remaja adalah ....",
                type: "pg",
                options: [
                    "tidak relevan karena remaja tidak menggunakan media sosial",
                    "sangat relevan karena menggambarkan realitas kehidupan remaja saat ini",
                    "hanya relevan untuk remaja yang kaya",
                    "tidak ada hubungannya dengan kehidupan nyata"
                ],
                correct: 1,
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menilai relevansi peristiwa dengan kehidupan sehari-hari"
            },
            {
                text: `<div class="text-title">Teks 1: Pembelajaran Daring</div>
                Pembelajaran daring memberikan fleksibilitas waktu dan tempat. Siswa dapat mengakses materi kapan saja. Platform digital mempermudah pengumpulan tugas. Namun, tidak semua siswa memiliki akses internet stabil. Interaksi sosial berkurang dalam pembelajaran daring.
                
                <div class="text-title">Teks 2: Pembelajaran Tatap Muka</div>
                Pembelajaran tatap muka memungkinkan interaksi langsung dengan guru. Siswa dapat bertanya langsung saat mengalami kesulitan. Kegiatan praktikum lebih efektif dilakukan di sekolah. Namun, memerlukan kedisiplinan waktu dan kehadiran. Biaya transportasi menjadi beban tambahan bagi sebagian siswa.`,
                question: "Bandingkan kedua teks! Pilihlah pernyataan yang benar.",
                type: "multiple",
                options: [
                    "Teks 1 menekankan fleksibilitas, Teks 2 menekankan interaksi langsung",
                    "Kedua teks membahas kelebihan masing-masing metode pembelajaran",
                    "Teks 1 tidak memiliki kekurangan sama sekali",
                    "Kedua teks menunjukkan bahwa setiap metode memiliki tantangan"
                ],
                correct: [0, 1, 3],
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menilai kesesuaian berdasarkan perbandingan antarteks"
            },
            {
                text: `<div class="text-title">Cerpen: Senja di Dermaga</div>
                Angin laut berhembus sepoi-sepoi membelai wajahnya. Matahari perlahan tenggelam di ufuk barat, meninggalkan semburat jingga yang memukau. Ombak menghempas dermaga dengan ritme yang menenangkan jiwa. Hatinya penuh kenangan akan sahabat yang telah pergi. Air matanya mengalir tanpa suara, berbaur dengan semilir angin senja. Ia menyadari, kepergian adalah bagian dari kehidupan yang harus diterima.`,
                question: "Respons emosional yang tepat terhadap cerpen tersebut adalah ....",
                type: "pg",
                options: [
                    "perasaan gembira dan penuh semangat",
                    "perasaan haru, melankolis, namun penuh penerimaan",
                    "perasaan marah dan dendam",
                    "perasaan takut dan cemas"
                ],
                correct: 1,
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menyimpulkan respons emosional terhadap unsur teks fiksi"
            },
            {
                text: `<div class="text-title">Teks 1: Sampah Organik</div>
                Sampah organik berasal dari sisa makanan, daun, dan material alami lainnya. Dapat terurai secara alami dalam waktu singkat. Cocok diolah menjadi kompos untuk pupuk tanaman. Tidak mencemari lingkungan jika dikelola dengan baik.
                
                <div class="text-title">Teks 2: Sampah Anorganik</div>
                Sampah anorganik berasal dari plastik, logam, dan kaca. Memerlukan waktu ratusan tahun untuk terurai. Dapat didaur ulang menjadi produk baru. Jika tidak dikelola akan mencemari tanah dan air.`,
                question: "Berdasarkan kedua teks, pernyataan yang akurat adalah ....",
                type: "category",
                categoryQuestion: "Tentukan keakuratan pernyataan berdasarkan kedua teks",
                categories: [
                    { statement: "Sampah organik lebih mudah terurai daripada anorganik", options: ["Benar", "Salah"] },
                    { statement: "Sampah anorganik tidak dapat didaur ulang", options: ["Benar", "Salah"] },
                    { statement: "Kedua jenis sampah memerlukan pengelolaan yang tepat", options: ["Benar", "Salah"] },
                    { statement: "Sampah organik selalu mencemari lingkungan", options: ["Benar", "Salah"] }
                ],
                correct: [0, 1, 0, 1],
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menilai keakuratan isi berdasarkan perbandingan antarteks"
            },
            {
                text: `<div class="text-title">Puisi: Pagi di Desaku</div>
                Embun pagi membasahi rerumputan
                Kicau burung membangunkan desa
                Asap dapur mengepul dari rumah-rumah
                Aroma kopi bercampur harum bunga
                Sawah-sawah hijau terbentang luas
                Inilah surgaku yang sederhana`,
                question: "Setelah membaca puisi, respons emosional yang tepat adalah ....",
                type: "pg",
                options: [
                    "perasaan sedih dan kesepian",
                    "perasaan damai, nostalgia, dan cinta pada kampung halaman",
                    "perasaan marah dan kecewa",
                    "perasaan takut dan was-was"
                ],
                correct: 1,
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menyimpulkan respons emosional terhadap unsur teks fiksi"
            },
            {
                text: `<div class="text-title">Teks Artikel: Bullying di Sekolah</div>
                Kasus bullying di sekolah meningkat 30% dalam setahun terakhir. Korban mengalami trauma psikologis jangka panjang. Beberapa siswa bahkan mengalami depresi dan kecenderungan menyakiti diri. Sekolah mulai menerapkan program anti-bullying. Peran guru dan orang tua sangat penting dalam pencegahan. Siswa diedukasi tentang empati dan menghargai perbedaan.`,
                question: "Relevansi isi artikel dengan kehidupan remaja adalah ....",
                type: "pg",
                options: [
                    "tidak relevan karena bullying hanya terjadi di film",
                    "sangat relevan karena bullying adalah masalah nyata di lingkungan sekolah",
                    "hanya relevan untuk siswa yang lemah",
                    "tidak berhubungan dengan kehidupan sehari-hari"
                ],
                correct: 1,
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menilai relevansi peristiwa dengan kehidupan sehari-hari"
            },
            {
                text: `<div class="text-title">Teks 1: Energi Fosil</div>
                Energi fosil seperti minyak, gas, dan batubara masih mendominasi sumber energi dunia. Harganya relatif murah dan infrastruktur sudah tersedia. Namun, menghasilkan emisi karbon tinggi. Cadangan fosil semakin menipis. Dampak lingkungannya sangat buruk untuk planet ini.
                
                <div class="text-title">Teks 2: Energi Terbarukan</div>
                Energi terbarukan seperti surya dan angin ramah lingkungan. Tidak menghasilkan emisi karbon. Sumber energinya tidak akan habis. Namun, biaya investasi awal masih tinggi. Teknologi terus berkembang dan biaya semakin terjangkau.`,
                question: "Bandingkan informasi kedua teks! Pernyataan yang akurat adalah ....",
                type: "multiple",
                options: [
                    "Energi fosil lebih murah tetapi berbahaya bagi lingkungan",
                    "Energi terbarukan lebih mahal namun berkelanjutan",
                    "Kedua sumber energi tidak memiliki kelebihan dan kekurangan",
                    "Transisi ke energi terbarukan perlu dilakukan bertahap"
                ],
                correct: [0, 1, 3],
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menilai kesesuaian isi berdasarkan perbandingan antarteks"
            },
            {
                text: `<div class="text-title">Cerpen: Pengorbanan Ibu</div>
                Ibu bangun sebelum fajar untuk menyiapkan sarapan. Tangannya yang keriput bergerak lincah di dapur. Ia selalu menyisihkan porsi terbaik untuk anak-anaknya. Meski lelah, wajahnya selalu cerah saat menyambut kami pulang. Pakaian kami selalu bersih dan harum. Ia tak pernah mengeluh meski hidup kami sederhana. Cintanya adalah pelita yang tak pernah padam.`,
                question: "Respons emosional yang muncul setelah membaca cerpen adalah ....",
                type: "pg",
                options: [
                    "perasaan bosan dan mengantuk",
                    "perasaan haru, kagum, dan syukur terhadap pengorbanan ibu",
                    "perasaan takut dan cemas",
                    "perasaan marah terhadap ibu"
                ],
                correct: 1,
                competency: "Evaluasi dan Apresiasi",
                subCompetency: "Menyimpulkan respons emosional terhadap unsur teks fiksi"
            }
        ];

        let currentQuestion = 0;
        let userAnswers = new Array(questions.length).fill(null);
        let answeredCount = 0;
        let studentName = '';

        function showNameInput() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('nameScreen').style.display = 'block';
            document.getElementById('studentName').focus();

            // Allow Enter key to submit
            document.getElementById('studentName').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    startTest();
                }
            });
        }

        function backToWelcome() {
            document.getElementById('nameScreen').style.display = 'none';
            document.getElementById('welcomeScreen').style.display = 'block';
        }

        function startTest() {
            const nameInput = document.getElementById('studentName').value.trim();

            if (nameInput === '') {
                alert('Silakan masukkan nama Anda terlebih dahulu!');
                document.getElementById('studentName').focus();
                return;
            }

            studentName = nameInput;
            document.getElementById('nameScreen').style.display = 'none';
            document.getElementById('questionSection').style.display = 'block';
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQuestion];
            const section = document.getElementById('questionSection');

            let optionsHTML = '';

            if (q.type === 'pg') {
                optionsHTML = q.options.map((opt, idx) => `
                    <div class="option" onclick="selectOption(${idx})">
                        <input type="radio" name="q${currentQuestion}" value="${idx}" 
                            ${userAnswers[currentQuestion] === idx ? 'checked' : ''}>
                        <span>${opt}</span>
                    </div>
                `).join('');
            } else if (q.type === 'multiple') {
                optionsHTML = q.options.map((opt, idx) => `
                    <div class="option" onclick="toggleMultiple(${idx})">
                        <input type="checkbox" id="opt${idx}" value="${idx}"
                            ${userAnswers[currentQuestion]?.includes(idx) ? 'checked' : ''}>
                        <span>${opt}</span>
                    </div>
                `).join('');
            } else if (q.type === 'category') {
                optionsHTML = `
                    <p style="margin-bottom: 15px; font-weight: 500;">${q.categoryQuestion}</p>
                    <table class="category-table">
                        <thead>
                            <tr>
                                <th style="width: 60%;">Pernyataan</th>
                                ${q.categories[0].options.map(opt => `<th>${opt}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${q.categories.map((cat, idx) => `
                                <tr>
                                    <td>${cat.statement}</td>
                                    ${cat.options.map((opt, optIdx) => `
                                        <td>
                                            <div class="category-option">
                                                <label>
                                                    <input type="radio" name="cat${idx}" value="${optIdx}"
                                                        ${userAnswers[currentQuestion]?.[idx] === optIdx ? 'checked' : ''}
                                                        onchange="selectCategory(${idx}, ${optIdx})">
                                                </label>
                                            </div>
                                        </td>
                                    `).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }

            section.innerHTML = `
                <div class="text-box">${q.text}</div>
                <div class="question">
                    <div class="question-header">
                        <span class="question-number">Soal ${currentQuestion + 1} dari 30</span>
                        <span class="competency-badge">${q.competency}</span>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">${optionsHTML}</div>
                </div>
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="previousQuestion()" 
                        ${currentQuestion === 0 ? 'disabled' : ''}>
                        ‚Üê Sebelumnya
                    </button>
                    <button class="btn" onclick="nextQuestion()">
                        ${currentQuestion === questions.length - 1 ? 'Selesai' : 'Selanjutnya ‚Üí'}
                    </button>
                </div>
            `;

            updateProgress();
        }

        function selectOption(idx) {
            if (userAnswers[currentQuestion] === null) answeredCount++;
            userAnswers[currentQuestion] = idx;

            document.querySelectorAll('.option').forEach((opt, i) => {
                opt.classList.toggle('selected', i === idx);
            });
            document.querySelector(`input[value="${idx}"]`).checked = true;
            updateProgress();
        }

        function toggleMultiple(idx) {
            if (userAnswers[currentQuestion] === null) {
                userAnswers[currentQuestion] = [];
                answeredCount++;
            }

            const answers = userAnswers[currentQuestion];
            const index = answers.indexOf(idx);

            if (index > -1) {
                answers.splice(index, 1);
                if (answers.length === 0) {
                    userAnswers[currentQuestion] = null;
                    answeredCount--;
                }
            } else {
                answers.push(idx);
            }

            const checkbox = document.getElementById(`opt${idx}`);
            checkbox.checked = !checkbox.checked;
            checkbox.parentElement.classList.toggle('selected', checkbox.checked);
            updateProgress();
        }

        function selectCategory(catIdx, optIdx) {
            if (userAnswers[currentQuestion] === null) {
                userAnswers[currentQuestion] = new Array(questions[currentQuestion].categories.length).fill(null);
                answeredCount++;
            }

            userAnswers[currentQuestion][catIdx] = optIdx;
            updateProgress();
        }

        function updateProgress() {
            const progress = (answeredCount / questions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('answered').textContent = answeredCount;
            document.getElementById('percentage').textContent = Math.round(progress) + '%';
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                loadQuestion();
            } else {
                showResults();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }

        function showResults() {
            let correct = 0;
            const competencyStats = {
                'Pemahaman Tekstual': { correct: 0, total: 0 },
                'Pemahaman Inferensial': { correct: 0, total: 0 },
                'Evaluasi dan Apresiasi': { correct: 0, total: 0 }
            };

            questions.forEach((q, idx) => {
                const userAnswer = userAnswers[idx];
                let isCorrect = false;

                if (q.type === 'pg') {
                    isCorrect = userAnswer === q.correct;
                } else if (q.type === 'multiple') {
                    if (userAnswer && Array.isArray(userAnswer) && Array.isArray(q.correct)) {
                        const sortedUser = [...userAnswer].sort();
                        const sortedCorrect = [...q.correct].sort();
                        isCorrect = JSON.stringify(sortedUser) === JSON.stringify(sortedCorrect);
                    }
                } else if (q.type === 'category') {
                    if (userAnswer && Array.isArray(userAnswer) && Array.isArray(q.correct)) {
                        isCorrect = JSON.stringify(userAnswer) === JSON.stringify(q.correct);
                    }
                }

                if (isCorrect) {
                    correct++;
                    competencyStats[q.competency].correct++;
                }
                competencyStats[q.competency].total++;
            });

            const percentage = Math.round((correct / questions.length) * 100);

            document.getElementById('questionSection').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
            document.getElementById('finalScore').textContent = correct;
            document.getElementById('scorePercentage').textContent = percentage + '%';
            document.getElementById('correctAnswers').textContent = correct;
            document.getElementById('wrongAnswers').textContent = questions.length - correct;

            const competencyResults = document.getElementById('competencyResults');
            competencyResults.innerHTML = Object.entries(competencyStats).map(([name, stats]) => {
                const compPercentage = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
                return `
                    <div class="competency-card">
                        <h4>${name}</h4>
                        <div class="competency-score">${stats.correct}/${stats.total}</div>
                        <p style="font-size: 14px; color: #666; margin-top: 5px;">${compPercentage}% benar</p>
                    </div>
                `;
            }).join('');
        }

        function resetTest() {
            currentQuestion = 0;
            userAnswers = new Array(questions.length).fill(null);
            answeredCount = 0;
            document.getElementById('resultScreen').style.display = 'none';
            document.getElementById('welcomeScreen').style.display = 'block';
            updateProgress();
        }
    </script>
</body>

</html>